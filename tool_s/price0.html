<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>Áâ©ÂÉπÁ≠ÜË®òÊú¨(Ê¢ùÁ¢ºÁâà)</title>
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
    <style>
        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --primary-color: #5D737E;
            --bg-color: #F2F0EB;
            --accent-color: #A63D40;
            --low-price-color: #27AE60;
            --text-main: #3E3E3E;
            --text-sub: #8C8C8C;
            --card-bg: #FFFFFF;
        }

        body {
            font-family: -apple-system, system-ui, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            width: 100%;
            max-width: 450px;
        }

        .input-card {
            background: var(--card-bg);
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 15px;
            position: relative;
        }

        .form-row {
            display: flex;
            gap: 8px;
            margin-bottom: 10px;
        }

        .form-group {
            flex: 1;
            min-width: 0;
            position: relative;
        }

        label {
            display: block;
            font-size: 0.75rem;
            color: var(--text-sub);
            margin-bottom: 4px;
        }

        select,
        input {
            width: 100%;
            padding: 12px;
            border: 1px solid #CCC;
            border-radius: 6px;
            font-size: 1rem;
        }

        /* Ê¢ùÁ¢ºËº∏ÂÖ•ÂçÄÂ°äÊ®£Âºè */
        .barcode-group {
            display: flex;
            gap: 5px;
        }

        .barcode-group input {
            border-radius: 6px 0 0 6px;
            border-right: none;
        }

        .btn-scan {
            width: 50px;
            border-radius: 0 6px 6px 0;
            border: 1px solid #CCC;
            background: #EEE;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            padding: 0;
        }

        .autocomplete-list {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #DDD;
            z-index: 1000;
            max-height: 200px;
            overflow-y: auto;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            border-radius: 0 0 8px 8px;
        }

        .autocomplete-item {
            padding: 12px;
            cursor: pointer;
            border-bottom: 1px solid #F0F0F0;
        }

        button {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
        }

        .btn-add {
            background-color: var(--primary-color);
            color: white;
            margin-top: 5px;
        }

        .storage-tools {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }

        .btn-tool {
            background-color: #E0E0E0;
            font-size: 0.8rem;
            padding: 8px;
            flex: 1;
            color: var(--text-main);
        }

        .search-box {
            margin-bottom: 15px;
        }

        .search-box input {
            border: 2px solid var(--primary-color);
            border-radius: 25px;
            padding-left: 15px;
        }

        /* Âç°ÁâáËàáÂàóË°® */
        .item-card {
            background: var(--card-bg);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 12px;
            border-top: 4px solid var(--primary-color);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 5px;
            flex-wrap: wrap;
        }

        .item-title-group {
            flex: 1;
        }

        .item-name {
            font-weight: bold;
            font-size: 1.2rem;
            display: block;
        }

        .item-barcode {
            font-size: 0.8rem;
            color: #666;
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 4px;
            margin-top: 4px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .btn-action-sm {
            font-size: 0.7rem;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
            padding: 2px 6px;
            border-radius: 4px;
            cursor: pointer;
            background: none;
            width: auto;
            font-weight: normal;
            margin-left: 5px;
        }

        .header-actions {
            display: flex;
            gap: 5px;
        }

        .all-time-low {
            display: inline-block;
            background: #E8F5E9;
            color: var(--low-price-color);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: bold;
            margin-bottom: 10px;
            margin-top: 5px;
        }

        .history-list {
            border-top: 1px solid #EEE;
            padding-top: 10px;
        }

        .history-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px dashed #F0F0F0;
        }

        .history-row:last-child {
            border-bottom: none;
        }

        .history-info {
            flex: 1;
        }

        .history-meta {
            color: var(--text-sub);
            font-size: 0.75rem;
            margin-bottom: 2px;
        }

        .store-label {
            background: #EEE;
            padding: 1px 4px;
            border-radius: 3px;
            margin-right: 4px;
            color: var(--text-main);
        }

        .note-text {
            color: var(--accent-color);
            font-size: 0.75rem;
            font-style: italic;
        }

        .history-price-actions {
            text-align: right;
            min-width: 100px;
        }

        .history-price {
            font-weight: bold;
            font-size: 1rem;
            margin-bottom: 4px;
        }

        .low-badge {
            color: white;
            background: var(--low-price-color);
            padding: 1px 4px;
            border-radius: 3px;
            font-size: 0.65rem;
            margin-left: 5px;
        }

        .action-links {
            font-size: 0.7rem;
            color: #0066CC;
            text-decoration: underline;
            cursor: pointer;
        }

        .btn-del-link {
            color: #999;
            margin-left: 8px;
        }

        /* ÊéÉÊèèÂô® Modal */
        #scanner-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 9999;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        #reader {
            width: 100%;
            max-width: 500px;
        }

        .scan-close-btn {
            margin-top: 20px;
            padding: 10px 30px;
            background: white;
            color: black;
            border-radius: 20px;
            width: auto;
        }

        .scan-instruction {
            color: white;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }
    </style>
</head>

<body>

    <div id="scanner-modal">
        <div class="scan-instruction">Ë´ãÂ∞áÊ¢ùÁ¢ºÂ∞çÊ∫ñÊ°ÜÊ°Ü</div>
        <div id="reader"></div>
        <button class="scan-close-btn" onclick="stopScanner()">‚ùå ÈóúÈñâÊéÉÊèè</button>
    </div>

    <div class="container">
        <h3 style="text-align:center;">üì¶ Áâ©ÂÉπÁ≠ÜË®òÊú¨ v1.011</h3>

        <div class="input-card">
            <div class="form-row">
                <div class="form-group" style="flex: 0.7;"><label>Âú∞Èªû</label><select id="store">
                        <option>ÂÖ®ËÅØ</option>
                        <option>ÂÆ∂Ê®ÇÁ¶è</option>
                        <option>ÂÖ®ÂÆ∂</option>
                        <option>7-11</option>
                        <option>Â•ΩÂ∏ÇÂ§ö</option>
                        <option>ÂÖ∂‰ªñ</option>
                    </select></div>
                <div class="form-group">
                    <label>Ê¢ùÁ¢º (ÂèØÈÅ∏)</label>
                    <div class="barcode-group">
                        <input type="text" id="barcodeInput" placeholder="ÊéÉÊèèÊàñËº∏ÂÖ•" oninput="checkBarcode(this.value)">
                        <button class="btn-scan" onclick="startScanner('new')">üì∑</button>
                    </div>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group"><label>Áâ©ÂìÅÂêçÁ®±</label><input type="text" id="itemName" placeholder="Áæ©ÁæéÁ∂ìÂÖ∏ÂéüÂë≥Â•∂Ëå∂18g18ÂåÖ"
                        autocomplete="off" oninput="showSuggestions(this.value)">
                    <div id="suggestionList" class="autocomplete-list" style="display:none;"></div>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group"><label>ÂñÆÂÉπ</label><input type="number" id="price" inputmode="decimal"></div>
                <div class="form-group"><label>ÂÇôË®ª</label><input type="text" id="note" placeholder="Ë≤∑‰∫åÈÄÅ‰∏Ä"></div>
            </div>
            <button class="btn-add" onclick="addItem()">Ë®òÈåÑÂÉπÊ†º</button>
            <div class="storage-tools">
                <button class="btn-tool" onclick="exportJSON()">üì§ ÂÇô‰ªΩ</button>
                <button class="btn-tool" onclick="document.getElementById('importFile').click()">üì• ÂåØÂÖ•</button>
                <input type="file" id="importFile" style="display:none" accept=".json" onchange="importJSON(event)">
            </div>
        </div>

        <div class="search-box"><input type="text" id="searchInput" oninput="renderList()" placeholder="üîç ÊêúÂ∞ãÂïÜÂìÅÊàñÊ¢ùÁ¢º...">
        </div>
        <div id="itemList"></div>
    </div>

    <script>
        // Ë≥áÊñôÁµêÊßãÊñ∞Â¢û barcode Ê¨Ñ‰Ωç
        let products = JSON.parse(localStorage.getItem('price_master_v11')) || [];
        // Á∞°ÂñÆÁöÑË≥áÊñôÈÅ∑ÁßªÔºöÂ¶ÇÊûúËàäË≥áÊñôÊ≤íÊúâ barcode Ê¨Ñ‰ΩçÔºåÁ¢∫‰øù‰πãÂæåÂ≠òÂèñ‰∏çÊúÉÂá∫ÈåØ

        let html5QrcodeScanner = null;
        let scanMode = 'new'; // 'new' or 'edit'
        let editingProductId = null;

        renderList();

        // --- ÊéÉÊèèÁõ∏ÈóúÈÇèËºØ ---

        function startScanner(mode, prodId = null) {
            scanMode = mode;
            editingProductId = prodId;
            document.getElementById('scanner-modal').style.display = 'flex';

            // Á¢∫‰øù DOM Â∑≤Á∂ìÈ°ØÁ§∫ÂæåÂÜçÂïüÂãï
            setTimeout(() => {
                if (!html5QrcodeScanner) {
                    html5QrcodeScanner = new Html5Qrcode("reader");
                }


                const config = {
                    fps: 10,
                    qrbox: { width: 300, height: 200 },
                    // ÈôêÂà∂Ê†ºÂºèÔºöÂÉÖÊîØÊè¥ EAN-13 Ëàá UPC-A
                    formatsToSupport: [
                        Html5QrcodeSupportedFormats.EAN_13,
                        Html5QrcodeSupportedFormats.UPC_A
                    ],
                    // Èè°È†≠ÊéßÂà∂
                    //videoConstraints: {focusMode: "continuous"}   // Ëá™ÂãïÂ∞çÁÑ¶‰ºº‰πéÁõ∏ÂÆπÂïèÈ°å-Êö´ÁßªÈô§
                };


                // ÂïüÂãïÊéÉÊèè
                html5QrcodeScanner.start(
                    { facingMode: "environment" },
                    config,
                    onScanSuccess
                )
                    .catch(err => {
                        console.error("Camera Error:", err);
                        alert("ÁÑ°Ê≥ïÂïüÂãïÁõ∏Ê©üÔºåË´ãÁ¢∫Ë™çÔºö\n1. ÊòØÂê¶‰ΩøÁî® HTTPS ÈÄ£Á∑ö\n2. Â∑≤ÊéàÊ¨äÁõ∏Ê©üÊ¨äÈôê\n3. Èè°È†≠Êú™Ë¢´ÂÖ∂‰ªñÁ®ãÂºè‰ΩîÁî®");
                        if (typeof stopScanner === "function") stopScanner();
                    });
            }, 100);


            function stopScanner() {
                document.getElementById('scanner-modal').style.display = 'none';
                if (html5QrcodeScanner) {
                    html5QrcodeScanner.stop().then(() => {
                        html5QrcodeScanner.clear();
                    }).catch(err => console.error(err));
                }
            }

            function onScanSuccess(decodedText, decodedResult) {
                stopScanner();
                // Êí≠ÊîæÊèêÁ§∫Èü≥ (ÂèØÈÅ∏)
                let audio = new Audio('beep.mp3'); audio.play();

                if (scanMode === 'new') {
                    // Êñ∞Â¢ûÊ®°Âºè
                    document.getElementById('barcodeInput').value = decodedText;
                    checkBarcode(decodedText); // Ëß∏ÁôºËá™ÂãïÂ°´ÂÖ•
                } else if (scanMode === 'edit' && editingProductId) {
                    // ‰øÆÊîπÊ®°Âºè
                    updateProductBarcode(editingProductId, decodedText);
                }
            }

            // Ê™¢Êü•Ê¢ùÁ¢ºÊòØÂê¶Â≠òÂú®ÊñºË≥áÊñôÂ∫´
            function checkBarcode(code) {
                if (!code) return;
                const existProd = products.find(p => p.barcode === code);
                if (existProd) {
                    // Â¶ÇÊûúÊâæÂà∞ÔºåËá™ÂãïÂ∏∂ÂÖ•ÂêçÁ®±
                    document.getElementById('itemName').value = existProd.name;
                    // Ë¶ñË¶∫ÊèêÁ§∫
                    document.getElementById('itemName').style.backgroundColor = "#E8F5E9";
                    setTimeout(() => document.getElementById('itemName').style.backgroundColor = "white", 1000);

                    // ÂèØ‰ª•ÈÅ∏ÊìáËÅöÁÑ¶Âà∞ÂÉπÊ†ºÊ¨Ñ‰Ωç
                    document.getElementById('price').focus();
                }
            }

            // ‰øÆÊîπÁâπÂÆöÂïÜÂìÅÁöÑÊ¢ùÁ¢º
            function updateProductBarcode(id, code) {
                let prod = products.find(p => p.id === id);

                // Ê™¢Êü•Ê¢ùÁ¢ºÊòØÂê¶Ë¢´ÂÖ∂‰ªñÂïÜÂìÅ‰ΩøÁî®
                const duplicate = products.find(p => p.barcode === code && p.id !== id);
                if (duplicate) {
                    if (!confirm(`Ê¢ùÁ¢º ${code} Â∑≤Ë¢´„Äå${duplicate.name}„Äç‰ΩøÁî®„ÄÇ\nÁ¢∫ÂÆöË¶ÅÂ∞áÊ≠§Ê¢ùÁ¢ºËΩâÁßªÁµ¶„Äå${prod.name}„ÄçÂóéÔºü`)) {
                        return;
                    }
                    // Ê∏ÖÈô§Âè¶‰∏ÄÂÄãÂïÜÂìÅÁöÑÊ¢ùÁ¢º‰ª•ÂÖçÈáçË§á (Ë¶ñÈúÄÊ±ÇËÄåÂÆöÔºåÈÄöÂ∏∏Ê¢ùÁ¢ºÊáâÂîØ‰∏Ä)
                    duplicate.barcode = "";
                }

                prod.barcode = code;
                saveAndRender();
                alert(`Â∑≤Êõ¥Êñ∞„Äå${prod.name}„ÄçÁöÑÊ¢ùÁ¢ºÁÇ∫Ôºö${code}`);
            }


            // --- ÂéüÊúâÈÇèËºØ‰øÆÊîπ ---

            function renameProduct(id) {
                let prod = products.find(p => p.id === id);
                const newName = prompt(`Â∞á„Äå${prod.name}„Äç‰øÆÊîπÁÇ∫Êñ∞ÁöÑÂìÅÂêç:`, prod.name);
                if (newName && newName.trim() !== "" && newName !== prod.name) {
                    const duplicate = products.find(p => p.name === newName.trim());
                    if (duplicate) {
                        if (confirm(`Â∑≤Êúâ„Äå${newName.trim()}„ÄçÁöÑÁ¥ÄÈåÑÔºåÊòØÂê¶Â∞áÂÖ©ËÄÖÂêà‰ΩµÔºü`)) {
                            duplicate.history = [...duplicate.history, ...prod.history];
                            // Âêà‰ΩµÊôÇÔºåÂ¶ÇÊûúËàäÁöÑÊúâÊ¢ùÁ¢ºÔºåÊñ∞ÁöÑÊ≤íÊúâÔºåÂâá‰øùÁïôËàäÁöÑÊ¢ùÁ¢º
                            if (!duplicate.barcode && prod.barcode) duplicate.barcode = prod.barcode;
                            products = products.filter(p => p.id !== id);
                        } else { return; }
                    } else {
                        prod.name = newName.trim();
                    }
                    saveAndRender();
                }
            }

            function showSuggestions(val) {
                const list = document.getElementById('suggestionList');
                if (!val) { list.style.display = 'none'; return; }
                // ÊêúÂ∞ãÂêçÁ®±
                const matches = products.filter(p => p.name.includes(val)).map(p => p.name).slice(0, 5);
                if (matches.length > 0) {
                    list.innerHTML = matches.map(m => `<div class="autocomplete-item" onclick="selectSuggestion('${m}')">${m}</div>`).join('');
                    list.style.display = 'block';
                } else { list.style.display = 'none'; }
            }

            function selectSuggestion(name) {
                document.getElementById('itemName').value = name;
                document.getElementById('suggestionList').style.display = 'none';

                // Ëá™ÂãïÂ∏∂ÂÖ•Ë©≤ÂïÜÂìÅÁöÑÊ¢ùÁ¢º (Â¶ÇÊûúÊúâ)
                const prod = products.find(p => p.name === name);
                if (prod && prod.barcode) {
                    document.getElementById('barcodeInput').value = prod.barcode;
                }

                document.getElementById('price').focus();
            }

            function addItem() {
                const store = document.getElementById('store').value;
                const name = document.getElementById('itemName').value.trim();
                const price = parseFloat(document.getElementById('price').value);
                const note = document.getElementById('note').value.trim();
                const barcode = document.getElementById('barcodeInput').value.trim(); // ÂèñÂæóÊ¢ùÁ¢º
                const date = new Date().toLocaleDateString('zh-TW');

                if (!name || isNaN(price)) return alert('Ë´ãËº∏ÂÖ•ÂêçÁ®±ËàáÂÉπÊ†º');

                // ÂÑ™ÂÖàÁî®Ê¢ùÁ¢ºÊâæÔºåÂÜçÁî®ÂêçÁ®±Êâæ
                let prod = products.find(p => (barcode && p.barcode === barcode) || p.name === name);

                const newRecord = { id: Date.now(), date, store, price, note };

                if (prod) {
                    // Â¶ÇÊûúÊòØÁî®ÂêçÁ®±ÊâæÂà∞ÁöÑÔºå‰ΩÜÁèæÂú®Ëº∏ÂÖ•‰∫ÜÊñ∞Ê¢ùÁ¢º‰∏îÂéüÊú¨Ê≤íÊúâÊ¢ùÁ¢ºÔºåÂâáË£ú‰∏ä
                    if (barcode && !prod.barcode) {
                        prod.barcode = barcode;
                    }
                    // Â¶ÇÊûúÂêçÁ®±ËÆä‰∫Ü‰ΩÜÊ¢ùÁ¢º‰∏ÄÊ®£ (ÂèØËÉΩÊòØ‰ΩøÁî®ËÄÖÊÉ≥‰øÆÊ≠£ÂêçÁ®±)ÔºåÈÄôË£°ÂÖà‰øùÊåÅÂéüÂêçÔºåÁî® rename ÂäüËÉΩ‰øÆÊîπËºÉÂÆâÂÖ®

                    prod.history.unshift(newRecord);
                } else {
                    // ÂÆåÂÖ®Êñ∞ÂïÜÂìÅ
                    products.unshift({
                        id: Date.now(),
                        name,
                        barcode: barcode, // ÂÑ≤Â≠òÊ¢ùÁ¢º
                        history: [newRecord]
                    });
                }

                saveAndRender();
                // Ê∏ÖÁ©∫Ê¨Ñ‰Ωç
                document.getElementById('itemName').value = '';
                document.getElementById('price').value = '';
                document.getElementById('note').value = '';
                document.getElementById('barcodeInput').value = '';
            }

            function editRecord(prodId, recordId) {
                let prod = products.find(p => p.id === prodId);
                let rec = prod.history.find(r => r.id === recordId);
                const newPrice = prompt(`‰øÆÊîπÂÉπÊ†º:`, rec.price);
                if (newPrice !== null && !isNaN(parseFloat(newPrice))) {
                    const newNote = prompt(`‰øÆÊîπÂÇôË®ª:`, rec.note);
                    rec.price = parseFloat(newPrice);
                    if (newNote !== null) rec.note = newNote;
                    saveAndRender();
                }
            }

            function deleteRecord(prodId, recordId) {
                if (confirm('Á¢∫ÂÆöÂà™Èô§Á¥ÄÈåÑÔºü')) {
                    let prod = products.find(p => p.id === prodId);
                    prod.history = prod.history.filter(r => r.id !== recordId);
                    if (prod.history.length === 0) products = products.filter(p => p.id !== prodId);
                    saveAndRender();
                }
            }

            function saveAndRender() {
                // Êõ¥Êñ∞ÁâàÊú¨Ëôü‰ª•ÂÖçÊ∑∑Ê∑Ü
                localStorage.setItem('price_master_v11', JSON.stringify(products));
                renderList();
            }

            function renderList() {
                const listDiv = document.getElementById('itemList');
                const search = document.getElementById('searchInput').value.toLowerCase();

                // ÊêúÂ∞ãÈÇèËºØÔºöÂêåÊôÇÊêúÂ∞ãÂêçÁ®±ËàáÊ¢ùÁ¢º
                const filtered = products.filter(p =>
                    p.name.toLowerCase().includes(search) ||
                    (p.barcode && p.barcode.includes(search))
                );

                listDiv.innerHTML = filtered.map(p => {
                    const minPrice = Math.min(...p.history.map(h => h.price));
                    return `
                <div class="item-card">
                    <div class="item-header">
                        <div class="item-title-group">
                            <span class="item-name">${p.name}</span>
                            ${p.barcode ? `<span class="item-barcode">üìä ${p.barcode} <button class="btn-action-sm" onclick="startScanner('edit', ${p.id})">‰øÆÊîπ</button></span>` :
                            `<button class="btn-action-sm" onclick="startScanner('edit', ${p.id})">‚ûï Á∂ÅÂÆöÊ¢ùÁ¢º</button>`}
                        </div>
                        <div class="header-actions">
                            <button class="btn-action-sm" onclick="renameProduct(${p.id})">ÈáçÂëΩÂêç</button>
                        </div>
                    </div>
                    <div class="all-time-low">üíé Ê≠∑Âè≤ÊúÄ‰ΩéÂÉπÔºö$${minPrice}</div>
                    <div class="history-list">
                        ${p.history.map(h => `
                            <div class="history-row">
                                <div class="history-info">
                                    <div class="history-meta"><span class="store-label">${h.store}</span>${h.date}</div>
                                    ${h.note ? `<div class="note-text">Ë®ª: ${h.note}</div>` : ''}
                                </div>
                                <div class="history-price-actions">
                                    <div class="history-price">$${h.price}${h.price === minPrice ? '<span class="low-badge">üî• Âè≤‰Ωé</span>' : ''}</div>
                                    <span class="action-links" onclick="editRecord(${p.id}, ${h.id})">‰øÆÊîπ</span>
                                    <span class="action-links btn-del-link" onclick="deleteRecord(${p.id}, ${h.id})">Âà™Èô§</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
                }).join('');
            }

            function exportJSON() {
                const blob = new Blob([JSON.stringify(products, null, 2)], { type: "application/json" });
                const a = Object.assign(document.createElement('a'), { href: URL.createObjectURL(blob), download: `ÂÉπÊ†ºÁ¥ÄÈåÑ_v11.json` });
                a.click();
            }

            function importJSON(event) {
                const file = event.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = (e) => {
                    try { products = JSON.parse(e.target.result); saveAndRender(); alert('ÂåØÂÖ•ÊàêÂäü'); }
                    catch (err) { alert('Ê™îÊ°àÊ†ºÂºè‰∏çÁõ∏ÂÆπ'); }
                };
                reader.readAsText(file);
            }
    </script>
</body>

</html>